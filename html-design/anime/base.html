{% spaceless %}
{% load animetemplates %}
{% load cache %}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <title>Anime catalog{% block title %}{% endblock %}</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="description" content="{% block description %}{% endblock %} Simple anime catalog. An easy way to create and manage your anime lists. No registration required.">
    <meta name="Keywords" content="anime, anime catalog,  anicat, {% block keywords %}animelist, anime list{% endblock %}">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon" />
    <link rel="search" type="application/opensearchdescription+xml" title="Anime catalog" href="/static/srch.xml" />
    <link href="/static/style.css" type="text/css" rel="stylesheet" />
    <link href="{% url user_css %}" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="/jsi18n/"></script>
    <script type="text/javascript" src="/static/js/element.js"></script>
    <script type="text/javascript" src="/static/script.js"></script>
    <script type="text/javascript" src="/static/ajax.js"></script>
    <script type="text/javascript" src="/static/forms.js"></script>
    <script type="text/javascript" src="/static/user.js"></script>
    <script type="text/javascript" src="/static/ae.js"></script>
    <script type="text/javascript" src="/static/card.js"></script>
    {% if not user.is_authenticated %}<script type="text/javascript" src="/static/userstorage.js"></script>{% endif %}
    {% block customScripts %}{% endblock %}
    {% if user.is_authenticated %}{% addForm %}{{ AddForm.media.render }}{% endif %}
</head>
<body>
    <div id="header" class="thdtbl">
        <div class="leftmenu">
            {% block mainlink %}
            <a href="/">Main</a>
            <span class="delimiter">|</span>
            {% endblock %}
            {% block searchlink %}
            <a href="{% url search %}" rel="nofollow" onclick="searcher.toggle(); return false;" accesskey="s">Search</a>
            <span class="delimiter">|</span>
            {% endblock %}
            <a href="{% url faq %}">FAQ</a><span class="delimiter">|</span>
            <a href="{% url card %}" rel="nofollow">Random</a>
        {% if user.is_authenticated %}
            {% block addLink %}
            <span class="delimiter">|</span>
            <a href="{% url edit_add %}" rel="nofollow" onclick="add.toggle(); return false;">Add⇣</a>
            {% endblock %}
        </div>
        <div id="logdiv" class="rightmenu">
            <span class="delimiter">|</span>
            <span><a href="{% url settings %}" title="User settings">{% username user %}</a></span>
            <span class="delimiter">|</span>
            <a href="{% url logout %}" onclick="user.logout();  return false;">Logout</a>
        </div>
        <div class="rightmenu">
            <a href="{% url statistics %}">Statistics</a>
            {% block selectView %}
            <span class="delimiter">|</span>
            <div class="select">
                <select id="show" onChange="setshow();">
                {# Это можно в какой-нибудь лист ужать #}
                    <option value="a">All</option>
                    <option value="0">None</option>
                    <option value="1">Want</option>
                    <option value="2">Now</option>
                    <option value="3">Watched</option>
                    <option value="4">Dropped</option>
                    <option value="5">Partially watched</option>
                </select>
                <span>Display Mode&nbsp;&nbsp;⇵</span>
            </div>
            {% endblock %}
        </div>
        {% else %}
        </div>
        <div id="logdiv" class="rightmenu">
            <a href="{% url login %}" onclick="return user.toggle();">Account</a>
        </div>
        <div id="logdv" class="right">
            {% loginForm %}
            <dl>
                <dd>
                    <form method="POST" action="{% url login %}" id="login" onsubmit="return user.login();">
                        {% csrf_token %}
                        {{ LoginForm.username }}
                        {{ LoginForm.password }}
                        <input type="submit" value="Login" />
                        <p id="logininfo" class="error">s</p>
                    </form>
                </dd>
                <dt><a id="register-more" class="inurl" onclick="user.more();">More⇣</a></dt>
            </dl>
            <dl id="logdvmore" class="right hidden">
                <dd>
                    <a rel="nofollow" href="{% url password_reset %}" class="inurl right">Restore password</a>
                    <p>
                    {% for name in social_auth.backends.openid %}
                        {% if  name != "openid" %}
                        <a rel="nofollow" target="_blank" onclick="return user.alterlogin('{% url socialauth_begin name %}');" class="inurl" href="{% url socialauth_begin name %}">{{ name|title }}</a>
                        {% endif %}
                    {% endfor %}
                        <a rel="nofollow" onclick="return user.alterlogin('openid');" class="inurl">OpenID</a>
                    </p>
                    <form id="login_openid" action="{% url socialauth_begin 'openid' %}" target="Login" method="post" onsubmit="return user.alterlogin('{% url socialauth_begin 'openid' %}');">
                        {% csrf_token %}
                        <input id="openid_identifier" type="text" value="" name="openid_identifier" />
                        <input type="submit" value="Login" />
                    </form>
                    <p id="socialinfo" class="error"></p>
                </dd>
                <dt class="inurl">Login with</dt>
                <dd>
                    <form method="POST" action="{% url registration %}" id="register" class="register"  onsubmit="return user.register();">
                        {% csrf_token %}
                        <p class="clear">
                        {% for field in RegisterForm %}
                            {{ field }}
                            {% if field.errors %}
                            <p class="error left">{{ field.errors }}</p>
                            {% endif %}
                        {% endfor %}
                        <input type="submit" class="clear" value="Register" />
                        </p>
                        <p class="mainerror error">
                            {{ RegisterForm.non_field_errors }}
                        </p>
                    </form>
                </dd>
                <dt class="inurl">Registration</dt>
            </dl>
        </div>
        {% endif %}
    </div>
    <br />
    {% block search %}
    <div id="srch" class="hidden">
        <form method="POST" action="{% url search %}" id="srchp" onsubmit="searcher.send(); return false;">
        {% csrf_token %}
            <input id="sin" name="string" type="text"/>
            <input type="submit" value="Search" />
        </form>
        <div id="srchres"></div>
    </div>
    {% endblock %}
    {% block main %}
    {% endblock %}
{% cache 0 footer user.is_authenticated %}
    <div class="cont_men" id="menu"></div>
    <div class="cont_men" id="popup">
        <span id="popups"></span>
    </div>
    <div class="footer">v. <a href="{% url changes %}" style="font-size: 10pt;">3.1.3</a>.</div>
    {% block addForm %}
    {% if user.is_authenticated %}
    <form id="addform" class="addform cont_men" action="{% url edit_add %}" method="post" enctype="multipart/form-data"
        onsubmit="return false;">
        {% csrf_token %}
        <div class="mainerror">{{ AddForm.non_field_errors }}</div>
        {% for field in AddForm %}
        <div {% if forloop.counter0|divisibleby:2 %}class="clear"{% endif %}>
            {{ field.label_tag }}: {{ field }}
            {{ field.errors }}
        </div>
        {% endfor %}
        <input type="submit" class="right" value="Add" onclick="add.sendForm(event); return false;" />
    </form>
    {% endif %}
    {% endblock %}
</body>
{% endcache %}
{% endspaceless %}
